---
import { Image } from 'astro:assets';
import plane from '../../public/images/plane.svg';
import '../styles/components/planes.scss';

const { number } = Astro.props;
---

<plane-animation class={`plane plane--${number}-oclock`}>
  <Image
    src={plane}
    width={122}
    height={112}
    alt="a paper plane graphic"
  />
</plane-animation>

<script>
  class PlaneAnimation extends HTMLElement {
    element: HTMLElement;

    constructor() {
      super();
      this.element = this;
    }

    connectedCallback() {
      this.enable();
    }

    enable() {
      this.observe();
    }

    observe() {
      // https://stackoverflow.com/questions/71553185/problem-with-using-intersectionobserver-to-trigger-css-animation

      // https://codepen.io/danwilson/pen/bwdmYo/

      const observer = new IntersectionObserver((entries) => {
        entries.map((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate');
          } else {
            entry.target.classList.remove('animate');
          }
        });
      });

      observer.observe(this.element);
    }
  }

  customElements.define('plane-animation', PlaneAnimation);
</script>